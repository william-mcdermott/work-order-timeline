<div
  class="overlay"
  *ngIf="initial as init"
  role="button"
  tabindex="0"
  aria-label="Close work order panel"
  (click)="onBackdropClick($event)"
  (keydown.enter)="onBackdropClick($event)"
  (keydown.space)="onBackdropClick($event)"
>
  <aside class="panel" role="dialog" aria-modal="true" tabindex="0">
    <header class="panel__header">
      <div class="panel__head-left">
        <div class="panel__title">{{ titleText() }}</div>
        <div class="panel__subtitle">Specify the dates, name and status for this order</div>
      </div>

      <div class="panel__head-right">
        <button class="btn btn--ghost" type="button" (click)="onCancel($event)">Cancel</button>
        <button class="btn btn--primary" type="button" (click)="onSubmit($event)">
          {{ primaryCtaText() }}
        </button>
      </div>
    </header>

    <div class="panel__divider"></div>

    <div class="panel__body">
      <!-- Work Order Name -->
      <div class="field">
        <label class="label" for="woName">Work Order Name</label>
        <input
          id="woName"
          #nameInput
          class="input"
          type="text"
          placeholder="e.g., Assemble Unit K"
          [class.is-error]="showNameRequired()"
          [formControl]="form.controls.name"
        />
        <div class="error" *ngIf="showNameRequired()">Work order name is required.</div>
      </div>

      <!-- Status -->
      <div class="field">
        <label class="label" for="woStatus">Status</label>

        <ng-select
          id="woStatus"
          class="ngs"
          [ngClass]="'ngs--' + (form.controls.status.value || 'open')"
          [items]="statusOptions"
          bindLabel="label"
          bindValue="value"
          [clearable]="false"
          [searchable]="false"
          [formControl]="form.controls.status"
        >
          <ng-template ng-label-tmp let-item="item">
            <span class="status-pill status-pill--{{ item.value }}">
              {{ item.label }}
            </span>
          </ng-template>

          <ng-template ng-option-tmp let-item="item">
            <div class="status-option">
              <span class="status-dot status-dot--{{ item.value }}"></span>
              <span class="status-option__label">{{ item.label }}</span>
            </div>
          </ng-template>
        </ng-select>
      </div>

      <!-- End date (vertical) -->
      <div class="field">
        <label class="label" for="woEnd">End date</label>

        <input
          id="woEnd"
          class="input"
          type="text"
          placeholder="MM.DD.YYYY"
          readonly
          ngbDatepicker
          #endDp="ngbDatepicker"
          [autoClose]="'outside'"
          [value]="formatDot(form.controls.endDate.value)"
          [class.is-error]="showEndRequired() || showDateOrderError() || !!externalError"
          (dateSelect)="onPickEnd($event)"
          (focus)="openEnd(endDp)"
        />
        <div class="error" *ngIf="showEndRequired()">End date is required.</div>
      </div>

      <!-- Start date (vertical) -->
      <div class="field">
        <label class="label" for="woStart">Start date</label>

        <input
          id="woStart"
          class="input"
          type="text"
          placeholder="MM.DD.YYYY"
          readonly
          ngbDatepicker
          #startDp="ngbDatepicker"
          [autoClose]="'outside'"
          [value]="formatDot(form.controls.startDate.value)"
          [class.is-error]="showStartRequired() || showDateOrderError() || !!externalError"
          (dateSelect)="onPickStart($event)"
          (focus)="openStart(startDp)"
        />
        <div class="error" *ngIf="showStartRequired()">Start date is required.</div>
      </div>

      <!-- Date ordering error -->
      <div class="error" *ngIf="showDateOrderError()">End date must be on or after start date.</div>

      <!-- Overlap / business rule error -->
      <div class="banner" *ngIf="externalError">{{ externalError }}</div>
    </div>
  </aside>
</div>
